<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Installation Guide • modeltime.gluonts</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Installation Guide">
<meta property="og:description" content="modeltime.gluonts">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-76139189-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-76139189-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">modeltime.gluonts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/getting-started.html">Getting Started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Start Here</li>
    <li>
      <a href="../articles/managing-envs.html">Installation</a>
    </li>
    <li>
      <a href="../articles/getting-started.html">Getting Started</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Advanced</li>
    <li>
      <a href="../articles/using-gpus.html">Using GPUs with GluonTS</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    API
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">API Functions</li>
    <li>
      <a href="../reference/index.html">
        <span class="fa fa-home"></span>
         
        Function Reference
      </a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Change History</li>
    <li>
      <a href="../news/index.html">News</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Ecosystem
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Forecast</li>
    <li>
      <a href="https://business-science.github.io/modeltime/">Modeltime (Forecasting)</a>
    </li>
    <li>
      <a href="https://business-science.github.io/timetk/">TimeTK (Time Series Analysis)</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Improve</li>
    <li>
      <a href="https://business-science.github.io/modeltime.ensemble/">Modeltime Ensemble (Blending Forecasts)</a>
    </li>
    <li>
      <a href="https://business-science.github.io/modeltime.resample/">Modeltime Resample (Backtesting)</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Scale</li>
    <li>
      <a href="https://business-science.github.io/modeltime.h2o/">Modeltime H2O (AutoML)</a>
    </li>
    <li>
      <a href="https://business-science.github.io/modeltime.gluonts/">Modeltime GluonTS (Deep Learning)</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting/">
    <span class="fas fa-graduation-cap"></span>
     
    Learn
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/business-science/modeltime.gluonts">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="managing-envs_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Installation Guide</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/business-science/modeltime.gluonts/blob/master/vignettes/managing-envs.Rmd"><code>vignettes/managing-envs.Rmd</code></a></small>
      <div class="hidden name"><code>managing-envs.Rmd</code></div>

    </div>

    
    
<div id="install-from-github" class="section level1">
<h1 class="hasAnchor">
<a href="#install-from-github" class="anchor"></a>Install from GitHub</h1>
<p>Modeltime GluonTS is maintained on GitHub and can be installed using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"business-science/modeltime.gluonts"</span><span class="op">)</span></code></pre></div>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p>There are 2 key components to installing <code>modeltime.gluonts</code>:</p>
<ol style="list-style-type: decimal">
<li><p>Download the R-Package, <code>modeltime.gluonts</code>. This installs the R-Bindings, which allows you to interface with GluonTS.</p></li>
<li><p>Set up the Python Environment so <code>modeltime.gluonts</code> can connect to the <code>gluonts</code> python package.</p></li>
</ol>
<div id="step-1-download-install-modeltime-gluonts" class="section level3">
<h3 class="hasAnchor">
<a href="#step-1-download-install-modeltime-gluonts" class="anchor"></a>Step 1: Download &amp; Install Modeltime GluonTS</h3>
<p>Download the latest GitHub version.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"business-science/modeltime.gluonts"</span><span class="op">)</span></code></pre></div>
</div>
<div id="step-2-default-python-environment-setup" class="section level3">
<h3 class="hasAnchor">
<a href="#step-2-default-python-environment-setup" class="anchor"></a>Step 2: Default Python Environment Setup</h3>
<p>We’ve provided a helper function, <code><a href="../reference/install_gluonts.html">install_gluonts()</a></code> to prepare and bind to a python environment containing <code>gluonts</code> and the required python packages.</p>
<ul>
<li>You only need to run this one time, and then you are good to go.</li>
<li>Each time you load <code>modeltime.gluonts</code>, the package will include this environment in it’s search process.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># GluonTS Installation - Run 1st time</span>
<span class="fu"><a href="../reference/install_gluonts.html">install_gluonts</a></span><span class="op">(</span>fresh_install <span class="op">=</span> <span class="cn">FALSE</span>, include_pytorch <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>What happens:</p>
<ul>
<li><p><code>fresh_install</code>: Default: <code>FALSE</code>. If <code>TRUE</code>, this removes any previous “r-gluonts” environments, which can help in the case of errors. <em>Caution: If you have added packages to this environment after a prior install, these packages will be removed.</em></p></li>
<li><p><code>include_pytorch</code>: Default: <code>FALSE</code>. If <code>TRUE</code>, will install the optional Pytorch and Pytorch Lightning dependencies for use with the “torch” engine, which is available in models such as <code><a href="../reference/deep_ar.html">deep_ar()</a></code>.</p></li>
</ul>
</div>
<div id="step-3-restart-r-and-try-an-example" class="section level3">
<h3 class="hasAnchor">
<a href="#step-3-restart-r-and-try-an-example" class="anchor"></a>Step 3: Restart R and Try an Example</h3>
<p>Restart your R session (if in RStudio, close and re-open). Then try this example.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/modeltime.gluonts">modeltime.gluonts</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org">tidymodels</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>

<span class="co"># Fit a GluonTS DeepAR Model</span>
<span class="va">model_fit_deepar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/deep_ar.html">deep_ar</a></span><span class="op">(</span>
    id                    <span class="op">=</span> <span class="st">"id"</span>,
    freq                  <span class="op">=</span> <span class="st">"M"</span>,
    prediction_length     <span class="op">=</span> <span class="fl">24</span>,
    lookback_length       <span class="op">=</span> <span class="fl">48</span>,
    epochs                <span class="op">=</span> <span class="fl">5</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">set_engine</span><span class="op">(</span><span class="st">"gluonts_deepar"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">fit</span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">.</span>, <span class="fu">training</span><span class="op">(</span><span class="va">m750_splits</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Forecast with 95% Confidence Interval</span>
<span class="fu">modeltime_table</span><span class="op">(</span>
    <span class="va">model_fit_deepar</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">modeltime_calibrate</span><span class="op">(</span>new_data <span class="op">=</span> <span class="fu">testing</span><span class="op">(</span><span class="va">m750_splits</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">modeltime_forecast</span><span class="op">(</span>
        new_data      <span class="op">=</span> <span class="fu">testing</span><span class="op">(</span><span class="va">m750_splits</span><span class="op">)</span>,
        actual_data   <span class="op">=</span> <span class="va">m750</span>,
        conf_interval <span class="op">=</span> <span class="fl">0.95</span>
    <span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">plot_modeltime_forecast</span><span class="op">(</span>.interactive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="../man/figures/deepar_example_1.png" width="90%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="upgrading-to-modeltime-gluonts-0-3-0" class="section level1">
<h1 class="hasAnchor">
<a href="#upgrading-to-modeltime-gluonts-0-3-0" class="anchor"></a>Upgrading to Modeltime GluonTS &gt;= 0.3.0</h1>
<p>Modeltime GluonTS 0.3.0 introduced new features that are only available in GluonTS &gt;= 0.8.0. To incorporate these features, we now need to upgrade GluonTS.</p>
<p>First, upgrade <code>modeltime.gluonts</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"business-science/modeltime.gluonts"</span><span class="op">)</span></code></pre></div>
<p>Next, we recommend running <code><a href="../reference/install_gluonts.html">install_gluonts()</a></code> with <code>fresh_install = TRUE</code>. This will completely replace your previous “r-gluonts” python environment with a new one. It’s designed to help reduce the likelihood of errors during the upgrading process.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/install_gluonts.html">install_gluonts</a></span><span class="op">(</span>fresh_install <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Optionally, you can add the <strong>Pytorch Backend</strong> (new feature) with:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/install_gluonts.html">install_gluonts</a></span><span class="op">(</span>fresh_install <span class="op">=</span> <span class="cn">TRUE</span>, include_pytorch <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="troubleshooting-installation" class="section level1">
<h1 class="hasAnchor">
<a href="#troubleshooting-installation" class="anchor"></a>Troubleshooting Installation</h1>
<p>Python Environment setup is always fun. Here are a few recommendations if you run into an issue.</p>
<ul>
<li><p><strong>Check to make sure Conda or Miniconda is available</strong> using <code><a href="https://rdrr.io/pkg/reticulate/man/conda-tools.html">reticulate::conda_version()</a></code>. If no conda version is returned, then use <code><a href="https://rdrr.io/pkg/reticulate/man/install_miniconda.html">reticulate::install_miniconda()</a></code> to install Miniconda (recommended vs full Aniconda). Then (re-)run <code><a href="../reference/install_gluonts.html">install_gluonts()</a></code>.</p></li>
<li><p><strong>Check if GluonTS (Python) is available</strong> using <code><a href="https://rdrr.io/pkg/reticulate/man/py_module_available.html">reticulate::py_module_available("gluonts")</a></code>. If this returns <code>TRUE</code>, then your installation has succeeded in building the environment, but you may have other issues like missing C++ build tools (next).</p></li>
<li><p><strong>Windows 10 error: Microsoft Visual C++ is required.</strong> <a href="https://github.com/business-science/modeltime.gluonts/issues/4">Here are the instructions for installing the C++ tools needed.</a></p></li>
<li><p><strong>Other installation issues.</strong> <a href="https://github.com/business-science/modeltime.gluonts/issues">Please file a GitHub issue here.</a></p></li>
</ul>
</div>
<div id="python-environment-requirements" class="section level1">
<h1 class="hasAnchor">
<a href="#python-environment-requirements" class="anchor"></a>Python Environment Requirements</h1>
<p>The <code>modeltime.gluonts</code> &gt;= 0.3.0 has the following minimum python environment requirements. We provide a helper function <code><a href="../reference/install_gluonts.html">install_gluonts()</a></code> to help set these up.</p>
<ul>
<li>A recent version of Python (Recommend 3.7)</li>
<li>A Python environment containing the “GluonTS Stack”:
<ul>
<li>
<code>gluonts&gt;=0.8.0</code> (required for <code>modeltime.gluonts</code> &gt;= 0.3.0)</li>
<li><code>mxnet</code></li>
<li><code>pandas</code></li>
<li><code>numpy</code></li>
<li><code>pathlib</code></li>
</ul>
</li>
</ul>
<p>Optional: Dependencies for Pytorch:</p>
<ul>
<li><code>torch</code></li>
<li><code>pytorch_lightning</code></li>
</ul>
<p>That’s it. If you have these inside a Conda or Virtual Environment, then you can use <code>modeltime.gluonts</code>.</p>
</div>
<div id="custom-python-environments" class="section level1">
<h1 class="hasAnchor">
<a href="#custom-python-environments" class="anchor"></a>Custom Python Environments</h1>
<p>There are 2 main ways to connect an python environment to <code>modeltime.gluonts</code>:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Default GluonTS Environment Setup</strong>: Most proven. Modeltime GluonTS creates an ‘r-gluonts’ environment with python package versions that were tested.</p></li>
<li><p><strong>Custom GluonTS Environment Setup</strong>: Most flexible. You create the environment, you ensure that dependency requirements are met, and you define how to connect to it.</p></li>
</ol>
<div id="method-1-modifying-the-default-environment-setup" class="section level2">
<h2 class="hasAnchor">
<a href="#method-1-modifying-the-default-environment-setup" class="anchor"></a>Method 1: Modifying the Default Environment Setup</h2>
<p>This process uses the <strong>Conda Package Manager</strong> to set up a new conda environment called “r-gluonts”. It’s quick and easy, and most importantly the package versions that are selected all work together (I test them when developing). And, you can modify it once created.</p>
<div id="make-sure-you-have-conda" class="section level3">
<h3 class="hasAnchor">
<a href="#make-sure-you-have-conda" class="anchor"></a>1. Make sure you have conda</h3>
<p>Get the conda version. If you don’t have conda, then install with <code><a href="https://rdrr.io/pkg/reticulate/man/install_miniconda.html">reticulate::install_miniconda()</a></code> or <code><a href="https://rdrr.io/pkg/reticulate/man/conda-tools.html">reticulate::conda_install()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/conda-tools.html">conda_version</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="run-install_gluonts-set-up-the-default-environment" class="section level3">
<h3 class="hasAnchor">
<a href="#run-install_gluonts-set-up-the-default-environment" class="anchor"></a>2. Run install_gluonts() (set up the Default Environment):</h3>
<p>This downloads the “GluonTS Stack” that the <code>modeltime.gluonts</code> package is tested using and places it into a Conda environment named “r-gluonts”. When you run <code><a href="https://github.com/business-science/modeltime.gluonts">library("modeltime.gluonts")</a></code>, it attempts to use the “r-gluonts” environment.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">modeltime.gluonts</span><span class="fu">::</span><span class="fu"><a href="../reference/install_gluonts.html">install_gluonts</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="optional-modifying-the-default-environment" class="section level3">
<h3 class="hasAnchor">
<a href="#optional-modifying-the-default-environment" class="anchor"></a>3. [Optional] Modifying the Default Environment:</h3>
<p>You can modify this environment, adding more python libraries as needed.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/py_install.html">py_install</a></span><span class="op">(</span>
    envname  <span class="op">=</span> <span class="st">"r-gluonts"</span>,
    packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="st">"sklearn"</span>
    <span class="op">)</span>,
    method <span class="op">=</span> <span class="st">"conda"</span>,
    pip <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="activate-the-default-environment" class="section level3">
<h3 class="hasAnchor">
<a href="#activate-the-default-environment" class="anchor"></a>4. Activate the Default Environment:</h3>
<p>Each time you load <code><a href="https://github.com/business-science/modeltime.gluonts">library(modeltime.gluonts)</a></code>, the package will bind to the “r-gluonts” python environment by default. If found, it will automatically bind to this environment.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/modeltime.gluonts">modeltime.gluonts</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="check-the-environment" class="section level3">
<h3 class="hasAnchor">
<a href="#check-the-environment" class="anchor"></a>5. Check the Environment</h3>
<p>Make sure that the environment has been changed to the default ‘r-gluonts’ environment. We can see that <code>r-gluonts</code> environment is being used in the python path.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/py_discover_config.html">py_discover_config</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="discover_config_rgluonts.jpg" width="90%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="method-2-making-custom-environments" class="section level2">
<h2 class="hasAnchor">
<a href="#method-2-making-custom-environments" class="anchor"></a>Method 2: Making Custom Environments</h2>
<p>It’s quite possible you may have a Virtual Environment or different Conda Environment that you would prefer to use. This is possible by setting a <strong>System Environment Variable named ‘GLUONTS_PYTHON’</strong> before running <code><a href="https://github.com/business-science/modeltime.gluonts">library(modeltime.gluonts)</a></code>.</p>
<div id="create-a-custom-python-environment" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-custom-python-environment" class="anchor"></a>1. Create a Custom Python Environment</h3>
<p>You can create an environment containing the python packages needed.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/py_install.html">py_install</a></span><span class="op">(</span>
    envname  <span class="op">=</span> <span class="st">"my_gluonts_env"</span>,
    python_version <span class="op">=</span> <span class="st">"3.6"</span>,
    packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
        <span class="st">"mxnet==1.6.0"</span>,
        <span class="st">"gluonts==0.6.3"</span>,
        <span class="st">"pandas"</span>,
        <span class="st">"numpy"</span>,
        <span class="st">"pathlib"</span>
    <span class="op">)</span>,
    method <span class="op">=</span> <span class="st">"conda"</span>,
    pip <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="locate-the-python-path" class="section level3">
<h3 class="hasAnchor">
<a href="#locate-the-python-path" class="anchor"></a>2. Locate the Python Path</h3>
<p>This locates the path to the python executable for the ‘my_gluonts_env’ environment that we just created.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="va">my_gluonts_env_python_path</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/conda-tools.html">conda_list</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">==</span> <span class="st">"my_gluonts_env"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">python</span><span class="op">)</span>

<span class="va">my_gluonts_env_python_path</span>
<span class="co">#&gt; "/Users/mdancho/Library/r-miniconda/envs/my_gluonts_env/bin/python"</span></code></pre></div>
</div>
<div id="set-the-system-environment-variable" class="section level3">
<h3 class="hasAnchor">
<a href="#set-the-system-environment-variable" class="anchor"></a>3. Set the System Environment Variable</h3>
<p>Set the system environment variable named ‘GLUONTS_PYTHON’ with the path to the python executable. Once this is set, loading <code><a href="https://github.com/business-science/modeltime.gluonts">library(modeltime.gluonts)</a></code> will use this path to activate the environment.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span><span class="op">(</span>GLUONTS_PYTHON <span class="op">=</span> <span class="va">my_gluonts_env_python_path</span><span class="op">)</span></code></pre></div>
<p>Verify it’s been set.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"GLUONTS_PYTHON"</span><span class="op">)</span>
<span class="co">#&gt; "/Users/mdancho/Library/r-miniconda/envs/my_gluonts_env/bin/python"</span></code></pre></div>
</div>
<div id="load-modeltime-gluonts" class="section level3">
<h3 class="hasAnchor">
<a href="#load-modeltime-gluonts" class="anchor"></a>5. Load Modeltime GluonTS</h3>
<p>Running <code><a href="https://github.com/business-science/modeltime.gluonts">library(modeltime.gluonts)</a></code> now binds to the custom environment.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/modeltime.gluonts">modeltime.gluonts</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="gotcha-1-check-your-environment" class="section level3">
<h3 class="hasAnchor">
<a href="#gotcha-1-check-your-environment" class="anchor"></a>6. [Gotcha #1] Check Your Environment</h3>
<p>Make sure that the environment has been changed to the default reticulate environment. We can see that environment is being used. If setting your python environment was done properly, you should see <code>my_gluonts_env</code> in the Python Path.</p>
<p><strong>Troubleshooting</strong>: If the incorrect environment is shown, simply restart your R Session,</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/py_discover_config.html">py_discover_config</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="discover_config_custom.jpg" width="90%" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matt Dancho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
