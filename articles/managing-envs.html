<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="modeltime.gluonts">
<title>Installation Guide • modeltime.gluonts</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Installation Guide">
<meta property="og:description" content="modeltime.gluonts">
<meta property="og:image" content="https://business-science.github.io/modeltime.gluonts/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-20GDZ5LL77"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-20GDZ5LL77');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">modeltime.gluonts</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/getting-started.html">Getting Started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Start Here</h6>
    <a class="dropdown-item" href="../articles/managing-envs.html">Installation</a>
    <a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Advanced</h6>
    <a class="dropdown-item" href="../articles/using-gpus.html">Using GPUs with GluonTS</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-api">API</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-api">
    <h6 class="dropdown-header" data-toc-skip>API Functions</h6>
    <a class="dropdown-item" href="../reference/index.html">
      <span class="fa fa-home"></span>
       
      Function Reference
    </a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Change History</h6>
    <a class="dropdown-item" href="../news/index.html">News</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-ecosystem">Ecosystem</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-ecosystem">
    <h6 class="dropdown-header" data-toc-skip>Forecast</h6>
    <a class="external-link dropdown-item" href="https://business-science.github.io/modeltime/">Modeltime (Forecasting)</a>
    <a class="external-link dropdown-item" href="https://business-science.github.io/timetk/">TimeTK (Time Series Analysis)</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Improve</h6>
    <a class="external-link dropdown-item" href="https://business-science.github.io/modeltime.ensemble/">Modeltime Ensemble (Blending Forecasts)</a>
    <a class="external-link dropdown-item" href="https://business-science.github.io/modeltime.resample/">Modeltime Resample (Backtesting)</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Scale</h6>
    <a class="external-link dropdown-item" href="https://business-science.github.io/modeltime.h2o/">Modeltime H2O (AutoML)</a>
    <a class="dropdown-item" href="https://business-science.github.io/modeltime.gluonts/">Modeltime GluonTS (Deep Learning)</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-python">Python</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-python">
    <h6 class="dropdown-header" data-toc-skip>Forecast</h6>
    <a class="external-link dropdown-item" href="https://business-science.github.io/pytimetk/">Timetk for Python (Time Series Analysis)</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://university.business-science.io/p/ds4b-203-r-high-performance-time-series-forecasting/">
    <span class="fas fa fas fa-graduation-cap"></span>
     
    Learn
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/business-science/modeltime.gluonts">
    <span class="fab fa fab fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Installation Guide</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/business-science/modeltime.gluonts/blob/master/vignettes/managing-envs.Rmd" class="external-link"><code>vignettes/managing-envs.Rmd</code></a></small>
      <div class="d-none name"><code>managing-envs.Rmd</code></div>
    </div>

    
    
<p>These are the full instructions to get <code>modeltime.gluonts</code>
installed, the python dependencies installed, and to connect R and
Python together so you can forecast with amazing accuracy.</p>
<p><img src="../reference/figures/m4_hourly_forecast.jpg" width="90%" style="display: block; margin: auto;"></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>There are 2 key components to installing
<code>modeltime.gluonts</code>:</p>
<ol style="list-style-type: decimal">
<li><p>Download the R-Package, <code>modeltime.gluonts</code>. This
installs the R-Bindings, which allows you to interface with
GluonTS.</p></li>
<li><p>Set up the Python Environment so <code>modeltime.gluonts</code>
can connect to the <code>gluonts</code> python package.</p></li>
</ol>
<div class="section level4">
<h4 id="step-1-download-install-modeltime-gluonts">Step 1: Download &amp; Install Modeltime GluonTS<a class="anchor" aria-label="anchor" href="#step-1-download-install-modeltime-gluonts"></a>
</h4>
<p>Modeltime GluonTS is maintained on GitHub and can be installed
using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"business-science/modeltime.gluonts"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-2-default-python-environment-setup">Step 2: Default Python Environment Setup<a class="anchor" aria-label="anchor" href="#step-2-default-python-environment-setup"></a>
</h4>
<p>We’ve provided a helper function, <code><a href="../reference/install_gluonts.html">install_gluonts()</a></code> to
prepare and bind to a python environment containing <code>gluonts</code>
and the required python packages.</p>
<ul>
<li>You only need to run this one time, and then you are good to
go.</li>
<li>Each time you load <code>modeltime.gluonts</code>, the package will
include this environment in it’s search process.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># GluonTS Installation - Run 1st time</span></span>
<span><span class="fu"><a href="../reference/install_gluonts.html">install_gluonts</a></span><span class="op">(</span>fresh_install <span class="op">=</span> <span class="cn">FALSE</span>, include_pytorch <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>What happens:</p>
<ul>
<li><p><code>fresh_install</code>: Default: <code>FALSE</code>. If
<code>TRUE</code>, this removes any previous “r-gluonts” environments,
which can help in the case of errors. <em>Caution: If you have added
packages to this environment after a prior install, these packages will
be removed.</em></p></li>
<li><p><code>include_pytorch</code>: Default: <code>FALSE</code>. If
<code>TRUE</code>, will install the optional Pytorch and Pytorch
Lightning dependencies for use with the “torch” engine, which is
available in models such as <code><a href="../reference/deep_ar.html">deep_ar()</a></code>.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="step-3-restart-r-and-try-an-example">Step 3: Restart R and Try an Example<a class="anchor" aria-label="anchor" href="#step-3-restart-r-and-try-an-example"></a>
</h4>
<p>Restart your R session (if in RStudio, close and re-open). Then try
this example.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/modeltime.gluonts" class="external-link">modeltime.gluonts</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit a GluonTS DeepAR Model</span></span>
<span><span class="va">model_fit_deepar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/deep_ar.html">deep_ar</a></span><span class="op">(</span></span>
<span>    id                    <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>    freq                  <span class="op">=</span> <span class="st">"M"</span>,</span>
<span>    prediction_length     <span class="op">=</span> <span class="fl">24</span>,</span>
<span>    lookback_length       <span class="op">=</span> <span class="fl">48</span>,</span>
<span>    epochs                <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">set_engine</span><span class="op">(</span><span class="st">"gluonts_deepar"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">fit</span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">.</span>, <span class="fu">training</span><span class="op">(</span><span class="va">m750_splits</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Forecast with 95% Confidence Interval</span></span>
<span><span class="fu"><a href="https://business-science.github.io/modeltime/reference/modeltime_table.html" class="external-link">modeltime_table</a></span><span class="op">(</span></span>
<span>    <span class="va">model_fit_deepar</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://business-science.github.io/modeltime/reference/modeltime_calibrate.html" class="external-link">modeltime_calibrate</a></span><span class="op">(</span>new_data <span class="op">=</span> <span class="fu">testing</span><span class="op">(</span><span class="va">m750_splits</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://business-science.github.io/modeltime/reference/modeltime_forecast.html" class="external-link">modeltime_forecast</a></span><span class="op">(</span></span>
<span>        new_data      <span class="op">=</span> <span class="fu">testing</span><span class="op">(</span><span class="va">m750_splits</span><span class="op">)</span>,</span>
<span>        actual_data   <span class="op">=</span> <span class="va">m750</span>,</span>
<span>        conf_interval <span class="op">=</span> <span class="fl">0.95</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://business-science.github.io/modeltime/reference/plot_modeltime_forecast.html" class="external-link">plot_modeltime_forecast</a></span><span class="op">(</span>.interactive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/deepar_example_1.png" width="90%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="upgrading-to-modeltime-gluonts-0-3-0">Upgrading to Modeltime GluonTS &gt;= 0.3.0<a class="anchor" aria-label="anchor" href="#upgrading-to-modeltime-gluonts-0-3-0"></a>
</h2>
<p>Modeltime GluonTS 0.3.0 introduced new features that are only
available in GluonTS &gt;= 0.8.0. To incorporate these features, we now
need to upgrade GluonTS.</p>
<p>First, upgrade <code>modeltime.gluonts</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"business-science/modeltime.gluonts"</span><span class="op">)</span></span></code></pre></div>
<p>Next, we recommend running <code><a href="../reference/install_gluonts.html">install_gluonts()</a></code> with
<code>fresh_install = TRUE</code>. This will completely replace your
previous “r-gluonts” python environment with a new one. It’s designed to
help reduce the likelihood of errors during the upgrading process.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/install_gluonts.html">install_gluonts</a></span><span class="op">(</span>fresh_install <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Optionally, you can add the <strong>Pytorch Backend</strong> (new
feature) with:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/install_gluonts.html">install_gluonts</a></span><span class="op">(</span>fresh_install <span class="op">=</span> <span class="cn">TRUE</span>, include_pytorch <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="troubleshooting-installation">Troubleshooting Installation<a class="anchor" aria-label="anchor" href="#troubleshooting-installation"></a>
</h2>
<p>Python Environment setup is always fun. Here are a few
recommendations if you run into an issue.</p>
<ul>
<li><p><strong>Check to make sure Conda or Miniconda is
available</strong> using <code><a href="https://rstudio.github.io/reticulate/reference/conda-tools.html" class="external-link">reticulate::conda_version()</a></code>. If no
conda version is returned, then use
<code><a href="https://rstudio.github.io/reticulate/reference/install_miniconda.html" class="external-link">reticulate::install_miniconda()</a></code> to install Miniconda
(recommended vs full Aniconda). Then (re-)run
<code><a href="../reference/install_gluonts.html">install_gluonts()</a></code>.</p></li>
<li><p><strong>Check if GluonTS (Python) is available</strong> using
<code>reticulate::py_module_available("gluonts")</code>. If this returns
<code>TRUE</code>, then your installation has succeeded in building the
environment, but you may have other issues like missing C++ build tools
(next).</p></li>
<li><p><strong>Windows 10 error: Microsoft Visual C++ is
required.</strong> <a href="https://github.com/business-science/modeltime.gluonts/issues/4" class="external-link">Here
are the instructions for installing the C++ tools needed.</a></p></li>
<li><p><strong>Other installation issues.</strong> <a href="https://github.com/business-science/modeltime.gluonts/issues" class="external-link">Please
file a GitHub issue here.</a></p></li>
</ul>
</div>
<div class="section level2">
<h2 id="python-environment-requirements">Python Environment Requirements<a class="anchor" aria-label="anchor" href="#python-environment-requirements"></a>
</h2>
<p>The <code>modeltime.gluonts</code> &gt;= 0.3.0 has the following
minimum python environment requirements. We provide a helper function
<code><a href="../reference/install_gluonts.html">install_gluonts()</a></code> to help set these up.</p>
<ul>
<li>A recent version of Python (Recommend 3.7)</li>
<li>A Python environment containing the “GluonTS Stack”:
<ul>
<li>
<code>gluonts&gt;=0.8.0</code> (required for
<code>modeltime.gluonts</code> &gt;= 0.3.0)</li>
<li><code>mxnet~=1.7</code></li>
<li><code>pandas</code></li>
<li><code>numpy</code></li>
<li><code>pathlib</code></li>
<li><code>ujson</code></li>
</ul>
</li>
</ul>
<p>Optional: Dependencies for Pytorch:</p>
<ul>
<li><code>torch</code></li>
<li><code>pytorch-lightning</code></li>
</ul>
<p><strong>Test Environment:</strong> These package versions are tested
on Windows, Mac, and Linux systems and can be used to set up an
environment:</p>
<ul>
<li><code>gluonts==0.8.0</code></li>
<li><code>mxnet~=1.7</code></li>
<li><code>numpy</code></li>
<li><code>pandas==1.0.5</code></li>
<li><code>pathlib==1.0.1</code></li>
<li><code>ujson==4.0.2</code></li>
<li><code>torch~=1.6</code></li>
<li><code>pytorch-lightning~=1.1</code></li>
</ul>
<p>That’s it. If you have these inside a Conda or Virtual Environment,
then you can use <code>modeltime.gluonts</code>.</p>
</div>
<div class="section level2">
<h2 id="custom-python-environments">Custom Python Environments<a class="anchor" aria-label="anchor" href="#custom-python-environments"></a>
</h2>
<p>There are 2 main ways to connect an python environment to
<code>modeltime.gluonts</code>:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Default GluonTS Environment Setup</strong>: Most proven.
Modeltime GluonTS creates an ‘r-gluonts’ environment with python package
versions that were tested.</p></li>
<li><p><strong>Custom GluonTS Environment Setup</strong>: Most flexible.
You create the environment, you ensure that dependency requirements are
met, and you define how to connect to it.</p></li>
</ol>
<div class="section level3">
<h3 id="method-1-modifying-the-default-environment-setup">Method 1: Modifying the Default Environment Setup<a class="anchor" aria-label="anchor" href="#method-1-modifying-the-default-environment-setup"></a>
</h3>
<p>This process uses the <strong>Conda Package Manager</strong> to set
up a new conda environment called “r-gluonts”. It’s quick and easy, and
most importantly the package versions that are selected all work
together (I test them when developing). And, you can modify it once
created.</p>
<div class="section level4">
<h4 id="make-sure-you-have-conda">1. Make sure you have conda<a class="anchor" aria-label="anchor" href="#make-sure-you-have-conda"></a>
</h4>
<p>Get the conda version. If you don’t have conda, then install with
<code><a href="https://rstudio.github.io/reticulate/reference/install_miniconda.html" class="external-link">reticulate::install_miniconda()</a></code> or
<code><a href="https://rstudio.github.io/reticulate/reference/conda-tools.html" class="external-link">reticulate::conda_install()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/conda-tools.html" class="external-link">conda_version</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="run-install_gluonts-set-up-the-default-environment">2. Run install_gluonts() (set up the Default Environment):<a class="anchor" aria-label="anchor" href="#run-install_gluonts-set-up-the-default-environment"></a>
</h4>
<p>This downloads the “GluonTS Stack” that the
<code>modeltime.gluonts</code> package is tested using and places it
into a Conda environment named “r-gluonts”. When you run
<code><a href="https://github.com/business-science/modeltime.gluonts" class="external-link">library("modeltime.gluonts")</a></code>, it attempts to use the
“r-gluonts” environment.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">modeltime.gluonts</span><span class="fu">::</span><span class="fu"><a href="../reference/install_gluonts.html">install_gluonts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="optional-modifying-the-default-environment">3. [Optional] Modifying the Default Environment:<a class="anchor" aria-label="anchor" href="#optional-modifying-the-default-environment"></a>
</h4>
<p>You can modify this environment, adding more python libraries as
needed.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_install.html" class="external-link">py_install</a></span><span class="op">(</span></span>
<span>    envname  <span class="op">=</span> <span class="st">"r-gluonts"</span>,</span>
<span>    packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"sklearn"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"conda"</span>,</span>
<span>    pip <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="activate-the-default-environment">4. Activate the Default Environment:<a class="anchor" aria-label="anchor" href="#activate-the-default-environment"></a>
</h4>
<p>Each time you load <code><a href="https://github.com/business-science/modeltime.gluonts" class="external-link">library(modeltime.gluonts)</a></code>, the
package will bind to the “r-gluonts” python environment by default. If
found, it will automatically bind to this environment.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/modeltime.gluonts" class="external-link">modeltime.gluonts</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="check-the-environment">5. Check the Environment<a class="anchor" aria-label="anchor" href="#check-the-environment"></a>
</h4>
<p>Make sure that the environment has been changed to the default
‘r-gluonts’ environment. We can see that <code>r-gluonts</code>
environment is being used in the python path.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_discover_config.html" class="external-link">py_discover_config</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="discover_config_rgluonts.jpg" width="90%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="method-2-making-custom-environments">Method 2: Making Custom Environments<a class="anchor" aria-label="anchor" href="#method-2-making-custom-environments"></a>
</h3>
<p>It’s quite possible you may have a Virtual Environment or different
Conda Environment that you would prefer to use. This is possible by
setting a <strong>System Environment Variable named
‘GLUONTS_PYTHON’</strong> before running
<code><a href="https://github.com/business-science/modeltime.gluonts" class="external-link">library(modeltime.gluonts)</a></code>.</p>
<div class="section level4">
<h4 id="create-a-custom-python-environment">1. Create a Custom Python Environment<a class="anchor" aria-label="anchor" href="#create-a-custom-python-environment"></a>
</h4>
<p>You can create an environment containing the python packages
needed.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_install.html" class="external-link">py_install</a></span><span class="op">(</span></span>
<span>    envname  <span class="op">=</span> <span class="st">"my_gluonts_env"</span>,</span>
<span>    python_version <span class="op">=</span> <span class="st">"3.7"</span>,</span>
<span>    packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"mxnet~=1.7"</span>,</span>
<span>        <span class="st">"gluonts==0.8.0"</span>,</span>
<span>        <span class="st">"pandas==1.0.5"</span>,</span>
<span>        <span class="st">"numpy"</span>,</span>
<span>        <span class="st">"pathlib==1.0.1"</span>,</span>
<span>        <span class="st">"ujson==4.0.2"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"conda"</span>,</span>
<span>    pip <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="locate-the-python-path">2. Locate the Python Path<a class="anchor" aria-label="anchor" href="#locate-the-python-path"></a>
</h4>
<p>This locates the path to the python executable for the
‘my_gluonts_env’ environment that we just created.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">my_gluonts_env_python_path</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/conda-tools.html" class="external-link">conda_list</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">==</span> <span class="st">"my_gluonts_env"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">python</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_gluonts_env_python_path</span></span>
<span><span class="co">#&gt; "/Users/mdancho/Library/r-miniconda/envs/my_gluonts_env/bin/python"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="set-the-system-environment-variable">3. Set the System Environment Variable<a class="anchor" aria-label="anchor" href="#set-the-system-environment-variable"></a>
</h4>
<p>Set the system environment variable named ‘GLUONTS_PYTHON’ with the
path to the python executable. Once this is set, loading
<code><a href="https://github.com/business-science/modeltime.gluonts" class="external-link">library(modeltime.gluonts)</a></code> will use this path to activate
the environment.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>GLUONTS_PYTHON <span class="op">=</span> <span class="va">my_gluonts_env_python_path</span><span class="op">)</span></span></code></pre></div>
<p>Verify it’s been set.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"GLUONTS_PYTHON"</span><span class="op">)</span></span>
<span><span class="co">#&gt; "/Users/mdancho/Library/r-miniconda/envs/my_gluonts_env/bin/python"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="load-modeltime-gluonts">5. Load Modeltime GluonTS<a class="anchor" aria-label="anchor" href="#load-modeltime-gluonts"></a>
</h4>
<p>Running <code><a href="https://github.com/business-science/modeltime.gluonts" class="external-link">library(modeltime.gluonts)</a></code> now binds to the
custom environment.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/modeltime.gluonts" class="external-link">modeltime.gluonts</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="gotcha-1-check-your-environment">6. [Gotcha #1] Check Your Environment<a class="anchor" aria-label="anchor" href="#gotcha-1-check-your-environment"></a>
</h4>
<p>Make sure that the environment has been changed to the default
reticulate environment. We can see that environment is being used. If
setting your python environment was done properly, you should see
<code>my_gluonts_env</code> in the Python Path.</p>
<p><strong>Troubleshooting</strong>: If the incorrect environment is
shown, simply restart your R Session,</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_discover_config.html" class="external-link">py_discover_config</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="discover_config_custom.jpg" width="90%" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matt Dancho.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
